# Based on ssh-agent code
if [ "$(uname)" != "Darwin" ]; then return ; fi

PINENTRY=/usr/local/MacGPG2/libexec/pinentry-mac.app/Contents/MacOS/pinentry-mac

function start_gpg_agent () {
	/usr/bin/env gpg-agent --daemon --pinentry-program "$PINENTRY" &> /dev/null
	export SSH_AUTH_SOCK="$HOME/.gnupg/S.gpg-agent.ssh"
}

function kgpg () {
    ps aux | awk '/[g]pg-agent --daemon/ {print $2}' | xargs kill -9
    start_gpg_agent
}
